!function(t){var e=function(t,e,o,n){return new(o||(o=Promise))((function(r,i){function d(t){try{l(n.next(t))}catch(t){i(t)}}function a(t){try{l(n.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(d,a)}l((n=n.apply(t,e||[])).next())}))};const o="ws://<STP server>:<STP port>",n="https://maps.googleapis.com/maps/api/js?key=<Enter your Google Maps API key here>";let r,i,d,a,l;function s(){return e(this,void 0,void 0,(function*(){const n=new t.StpWebSocketsConnector(o);l=new t.StpRecognizer(n),l.onSymbolAdded=(t,e)=>{!function(t){const e='<div id="content"><div id="siteNotice"></div><h3 id="firstHeading" class="firstHeading">'+t.fullDescription+"</h3><table><tr><td>2525D PartA</td><td>"+t.sidc.partA+"</td></tr><tr><td>2525D PartB</td><td>"+t.sidc.partB+"</td></tr><tr><td>Symbol Set</td><td>"+t.sidc.symbolSet+"</td></tr><tr><td>2525C SIDC</td><td>"+t.sidc.legacy+"</td></tr><tr><td>Affiliation</td><td>"+t.affiliation+"</td></tr><tr><td>Echelon</td><td>"+t.echelon+"</td></tr><tr><td>Parent Unit</td><td>"+t.parent+"</td></tr><tr><td>Designator 1</td><td>"+t.designator1+"</td></tr><tr><td>Designator 2</td><td>"+t.designator2+"</td></tr><tr><td>Status</td><td>"+t.status+"</td></tr><tr><td>Modifier</td><td>"+t.modifier+"</td></tr><tr><td>Strength</td><td>"+t.strength+"</td></tr><tr><td>Time From</td><td>"+t.timeFrom+"</td></tr><tr><td>Time To</td><td>"+t.timeTo+"</td></tr><tr><td>Altitude</td><td>"+t.altitude+"</td></tr><tr><td>Min Altitude</td><td>"+t.minAltitude+"</td></tr><tr><td>Max Altitude</td><td>"+t.maxAltitude+'</td></tr></table><div id="bodyContent"></div></div>';let o={lat:t.location.centroid.lat,lng:t.location.centroid.lon},n=new google.maps.InfoWindow({content:e,position:o});if("tg"===t.fsTYPE){let e=t.location.coords.map((t=>({lat:t.lat,lng:t.lon}))),o={path:e,geodesic:!0,strokeColor:"black",strokeOpacity:1,strokeWeight:3};if("area"===t.location.fsTYPE){const t=new google.maps.Polygon(o);t.setMap(r),t.addListener("click",(()=>{n.open(r)}))}else{"arrowfat"==t.location.shape&&e.length--;const i=new google.maps.Polyline(o);i.setMap(r),i.addListener("click",(()=>{n.open(r)}))}}else{let e,i,d;"friend"===t.affiliation?(e="M -21,-15 -21,15 21,15 21,-15 z",i="#1077aa",d="#1077aa"):"hostile"===t.affiliation?(e="M -18,0 0,18 18,0 0,-18 z",i="red",d="red"):(e="M 0, 0 m -18, 0 a 18,18 0 1,0 36,0 a 18,18 0 1,0 -36,0",i="yellow",d="yellow");const a={fillOpacity:.5,scale:1,strokeWeight:1,path:e,fillColor:i,strokeColor:d},l=new google.maps.Marker({position:o,map:r,title:t.description,icon:a});l.addListener("click",(()=>{n.open(r,l)}))}}(t)},l.onInkProcessed=()=>{a&&a.setMap(null)},l.onSpeechRecognized=t=>{let e="";t&&t.length>0&&(e=t[0]),g(e)},l.onStpMessage=(t,e)=>{g(t,e,!0)};try{yield l.connect("GoogleMapsSample",0)}catch(e){g("Failed to connect to STP at "+o+". \nSymbols will not be recognized. Please reload to try again",t.StpMessageLevel.Error,!0)}const s=new t.AzureSpeechRecognizer("<Enter your Azure Speech subscription key here>","<Enter Azure's subscription region>"),p=document.getElementById("map");if(!p)throw new Error("Html page must contain a 'map' div");r=new google.maps.Map(p,{zoom:13,center:{lat:58.967774948,lng:11.196062412},gestureHandling:"cooperative",draggable:!1,draggableCursor:"crosshair"}),r.addListener("mousedown",(function(o){let n=o.vb;if(n.ctrlKey)return!1;n.preventDefault(),r.setOptions({draggable:!1,zoomControl:!1,scrollwheel:!1,disableDoubleClickZoom:!1}),l.sendPenDown(new t.LatLon(o.latLng.lat(),o.latLng.lng()),c()),function(t){e(this,void 0,void 0,(function*(){try{let e=yield t.recognize();e&&(l.sendSpeechRecognition(e.results,e.startTime,e.endTime),e.results&&e.results.length>0&&g(e.results[0].text))}catch(t){g("Failed to process speech: "+t.message)}}))}(s),function(e){i=c(),a&&a.setMap(null);a=new google.maps.Polyline({map:r,clickable:!1,strokeColor:"#8B0000",strokeWeight:2}),a.getPath().push(e);var o=google.maps.event.addListener(r,"mousemove",(t=>{a.getPath().push(t.latLng)}));google.maps.event.addListenerOnce(r,"mouseup",(e=>{d=c(),google.maps.event.removeListener(o),r.setOptions({draggable:!0,zoomControl:!0,scrollwheel:!0,disableDoubleClickZoom:!0});let n=a.getPath();1==n.getLength()&&n.push(n.getAt(0));let s=n.getArray().map((e=>new t.LatLon(e.lat(),e.lng()))),g={width:document.getElementById("map").clientWidth,height:document.getElementById("map").clientHeight},p=r.getBounds();if(!p)throw new Error("Failed to retrieve the map bounds - unable to send ink to STP");l.sendInk(new t.Size(g.width,g.height),new t.LatLon(p.getNorthEast().lat(),p.getSouthWest().lng()),new t.LatLon(p.getSouthWest().lat(),p.getNorthEast().lng()),s,i,d,[])}))}(o.latLng)}))}))}function c(){return(new Date).toISOString()}function g(t,e,o){o&&alert(t);let n=document.getElementById("messages");if(!n)throw new Error("Html page must contain a 'messages' div");n.innerHTML=t,n.style.color="Error"===e?"red":"black"}document.querySelectorAll('[src="'+n+'"]').length?s():document.body.appendChild(Object.assign(document.createElement("script"),{type:"text/javascript",src:n,onload:()=>s()}))}(StpSDK);